var fs=require("fs"),path=require("path"),exec=require("child_process").exec,gulp=require("gulp"),clean=require("gulp-clean"),rename=require("gulp-rename"),less=require("gulp-less"),livereload=require("gulp-livereload");gulp.task("clean-build",function(){return gulp.src(["build","dist"],{read:!1}).pipe(clean())}),gulp.task("less",function(){return gulp.src("./less/main.less").pipe(less({paths:[path.join(__dirname,"less"),path.join(__dirname,"..")],compress:!0})).pipe(gulp.dest("./dist/css"))}),gulp.task("build",["less","clean-build"],function(){exec("r.js.cmd -o build.js",function(e,l,s){return e?console.log(e):(gulp.src(["build/app/main.js"]).pipe(gulp.dest("dist")),gulp.src(["build/translate/es.js","build/translate/ca.js"]).pipe(gulp.dest("dist/translate")),gulp.src(["build/translate/locale/*"]).pipe(gulp.dest("dist/translate/locale")),void gulp.src(["build/dist.html"]).pipe(rename("index.html")).pipe(gulp.dest("dist")))})}),gulp.task("reload",function(){livereload.reload()}),gulp.task("watch",function(){livereload.listen(),gulp.watch(["./**/*"],["reload"])}),gulp.task("default",["watch"]);